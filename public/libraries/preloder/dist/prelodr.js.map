{"version":3,"file":"prelodr.js","sources":["../index.js"],"sourcesContent":["import Seqr from 'seqr'\nimport Emitus from 'emitus'\n\nexport default function prelodr (options = {}) {\n  let defaults = Object.assign(\n    {\n      container: document.body,\n      duration: 750,\n      zIndex: 100,\n      auto: false,\n      text: 'Loading...',\n      prefixClass: 'prelodr'\n    },\n    options\n  )\n\n  const emitter = Emitus({\n    show,\n    hide,\n    setText,\n    getElement,\n    setPrefixClass,\n    setDuration,\n    setZIndex\n  })\n\n  const seqr = Seqr()\n  let cls = getClasses()\n\n  const wrapper = el()\n  wrapper.className = `${cls.prefix} ${cls.hide}`\n  wrapper.innerHTML = `<span><span><span class=\"${cls.text}\">${defaults.text}</span><span class=\"${cls.progressbar}\"></span></span></span>`\n\n  const spanText = find(`.${cls.text}`)\n  const spanProgressbar = find(`.${cls.progressbar}`)\n\n  defaults.container.appendChild(wrapper)\n\n  if (defaults.auto) show(defaults.text)\n\n  setZIndex(defaults.zIndex)\n\n  return emitter\n\n  function show (str) {\n    seqr.then(done => {\n      setText(str)\n\n      wrapper.classList.remove(cls.hide)\n\n      setTimeout(() => {\n        spanText.classList.add(cls.in)\n        wrapper.classList.add(cls.in)\n      }, 10)\n\n      setTimeout(() => {\n        emitter.emit('shown')\n        done()\n      }, defaults.duration)\n    })\n\n    return emitter\n  }\n\n  function hide (fn) {\n    seqr.then(done => {\n      spanText.classList.remove(cls.in)\n      wrapper.classList.remove(cls.in)\n\n      setTimeout(() => {\n        wrapper.classList.add(cls.hide)\n\n        if (fn) fn(done)\n        else done()\n\n        emitter.emit('hidden')\n      }, defaults.duration)\n    })\n\n    return emitter\n  }\n\n  function setText (str) {\n    if (!str && defaults.text) str = defaults.text\n\n    defaults.text = str\n    spanText.innerHTML = str\n\n    return emitter\n  }\n\n  function getElement () {\n    return wrapper\n  }\n\n  function setDuration (duration) {\n    defaults.duration = duration\n  }\n\n  function setZIndex (zindex) {\n    defaults.zIndex = zindex\n    wrapper.style.zIndex = zindex\n  }\n\n  function setPrefixClass (prefix) {\n    defaults.prefixClass = prefix\n    updateClasses()\n  }\n\n  function updateClasses () {\n    const from = cls\n\n    cls = getClasses()\n    replaceClass(wrapper, from.prefix, cls.prefix)\n    replaceClass(spanText, from.text, cls.text)\n    replaceClass(spanProgressbar, from.progressbar, cls.progressbar)\n  }\n\n  function getClasses () {\n    return {\n      prefix: defaults.prefixClass,\n      in: `${defaults.prefixClass}-in`,\n      hide: `${defaults.prefixClass}-hide`,\n      text: `${defaults.prefixClass}-text`,\n      progressbar: `${defaults.prefixClass}-progressbar`\n    }\n  }\n\n  function el (tag = 'span') {\n    return document.createElement(tag)\n  }\n\n  function find (q) {\n    return wrapper.querySelector(q)\n  }\n\n  function replaceClass (elem, from, to) {\n    elem.classList.remove(from)\n    elem.classList.add(to)\n  }\n}\n"],"names":["let","const"],"mappings":"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"}